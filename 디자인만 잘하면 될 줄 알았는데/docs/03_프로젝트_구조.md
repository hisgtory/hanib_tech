# 프로젝트 구조

## 전체 디렉토리 구조

```
디자인만 잘하면 될 줄 알았는데/
├── CLAUDE.md                    # Claude 컨텍스트 (프로젝트 가이드)
├── docs/                        # 프로젝트 문서
│
├── part{NN}_{제목}/             # 콘텐츠: 파트
│   ├── meta.yaml
│   └── week{NN}_{제목}/         # 콘텐츠: 주차
│       ├── meta.yaml
│       ├── intro.md
│       └── ep{NN}_{제목}/       # 콘텐츠: 에피소드
│           ├── meta.yaml
│           ├── conversation.md  # 대화형 콘텐츠
│           ├── yama.md          # 핵심 메시지
│           ├── body.md          # 본문 설명
│           └── variants/        # 변형 버전들
│               ├── original/    # 원본
│               ├── v2/          # 변형 2
│               └── v3/          # 변형 3
│
├── tools/
│   └── hanib/                   # 에디터 도구
│       ├── cmd/
│       │   ├── cli/             # CLI 도구 (hanib)
│       │   └── server/          # 웹 서버
│       ├── pkg/
│       │   ├── content/         # 콘텐츠 파싱
│       │   └── git/             # Git 연동
│       └── web/                 # React 프론트엔드
│
└── _templates/                  # 템플릿 파일
```

## 콘텐츠 구조 상세

### 계층 구조
```
Part (파트)
└── Week (주차)
    └── Episode (에피소드)
        └── Variant (변형)
```

### 네이밍 규칙

| 레벨 | 패턴 | 예시 |
|------|------|------|
| Part | `part{NN}_{제목}` | `part01_제품을_만들기_전` |
| Week | `week{NN}_{제목}` | `week01_무엇을_만들지_찾아가기` |
| Episode | `ep{NN}_{제목}` | `ep01_린_스타트업` |
| Variant | 자유 | `original`, `v2`, `카드뉴스` |

### 에피소드 파일 구성

```
ep01_린_스타트업/
├── meta.yaml           # 메타데이터
├── conversation.md     # 한입-N 대화 (스토리)
├── yama.md            # 핵심 메시지 (한 줄 요약)
├── body.md            # 상세 설명 (개념, 팁, 체크리스트)
└── variants/
    ├── original/      # Notion에서 가져온 원본
    │   └── source.md
    ├── v2/            # 실무 체크리스트 버전
    │   ├── conversation.md
    │   ├── yama.md
    │   └── body.md
    └── v3/            # 카드뉴스 요약 버전
        ├── conversation.md
        ├── yama.md
        └── body.md
```

### meta.yaml 스키마

```yaml
# episode meta.yaml
title: "우리 팀이 제품을 검증하는 방법: 린 스타트업"
order: 1
status: "draft" | "review" | "final"
selected_variant: null  # 또는 "v2"
keywords:
  - 린 스타트업
  - MVP
  - 가설 검증
```

## 도구 구조 상세

### tools/hanib/cmd/cli/
CLI 도구 - 콘텐츠 관리 명령어

```bash
hanib list                           # 전체 구조 보기
hanib add part "제목"                # 파트 추가
hanib add week <part> "제목"         # 주차 추가
hanib add ep <part> <week> "제목"    # 에피소드 추가
hanib add var <ep-path> <name>       # 변형 추가
```

### tools/hanib/cmd/server/
웹 서버 - API 엔드포인트

| 엔드포인트 | 메서드 | 설명 |
|-----------|--------|------|
| `/api/tree` | GET | 콘텐츠 트리 조회 |
| `/api/file` | GET | 파일 읽기 |
| `/api/file` | PUT | 파일 저장 |
| `/api/file/mtime` | GET | 파일 수정 시간 |
| `/api/claude` | POST | Claude 채팅 (SSE) |
| `/api/git/status` | GET | Git 상태 |
| `/api/git/add` | POST | Git add |
| `/api/git/commit` | POST | Git commit |
| `/api/git/push` | POST | Git push |

### tools/hanib/pkg/content/
콘텐츠 파싱 로직

```go
// tree.go - 디렉토리 → 트리 구조 변환
type ContentTree struct {
    Root  string
    Parts []Part
}

// meta.go - meta.yaml 파싱
type Meta struct {
    Title  string
    Order  int
    Status string
}
```

### tools/hanib/web/
React 프론트엔드

```
web/src/
├── App.tsx              # 메인 앱
├── types.ts             # TypeScript 타입
└── components/
    ├── TreeView/        # 사이드바 트리
    ├── Editor/          # Monaco 에디터
    ├── Preview/         # 마크다운 프리뷰
    ├── Claude/          # Claude 채팅 패널
    └── GitPanel/        # Git 상태/커밋
```

## 마크다운 확장 문법

### 지원하는 커스텀 문법

```markdown
# 대화 블록
:::conversation
**한입**: 대사
**N**: 대사
:::

# 핵심 메시지
:::yama
핵심 메시지
:::

# 콜아웃
:::callout[tip]
팁 내용
:::

# 하이라이트
==강조할 텍스트==

# 일러스트 지시
[illust: ID="P1-W1-E02-01" DESC="설명"]
```

### 일러스트 ID 체계
- WEEK 표지: `P{파트}-W{주차}-COVER`
- 본문 그래픽: `P{파트}-W{주차}-E{에피소드}-{순번}`

## 빌드 결과물

```
tools/hanib/
├── hanib-cli          # CLI 바이너리
├── hanib-server       # 서버 바이너리
└── web/dist/          # 정적 프론트엔드
```

## 실행 방법

### 개발
```bash
# 백엔드 (터미널 1)
cd tools/hanib
go run ./cmd/server --port 3031

# 프론트엔드 (터미널 2)
cd tools/hanib/web
npm run dev  # localhost:3030
```

### 프로덕션
```bash
cd tools/hanib
make build
./hanib-server --port 3000
# localhost:3000에서 모든 기능 사용
```
